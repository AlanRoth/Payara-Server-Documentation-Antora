[[payara-java-util-logging-extensions]]
= Logging Properties

_Since version 5.2021.4_

The changes in logging also affected configuration. Now it is more flexible and also more intuitive.

If the logging.properties file is saved via Payara Server, it is automatically sorted alphabetically now,
so you can find the right line much faster, especially in combination with the fact that all out handlers
and formatters follow same rules.

== Handlers

|===
|Old Handler| New Replacement| Main Differences

| com.sun.enterprise.server.logging.GFFileHandler
| fish.payara.jul.handler.PayaraLogHandler
| not a HK2 service
new attribute names
refactored

| java.util.logging.ConsoleHandler
| fish.payara.jul.handler.SimpleLogHandler
| uses STDOUT instead STDERR by default
uses OneLineFormatter instead of SimpleFormatter by default

| java.util.logging.MemoryHandler
| fish.payara.jul.handler.LogCollectorHandler
| MemoryHandler works like a cyclic buffer, LogCollectorHandler has strictly programmatical usage for tests reviewing logs.

| com.sun.enterprise.server.logging.SyslogHandler
| fish.payara.jul.handler.SyslogHandler
| Obsoleted
|===

== Handler Properties

|===
|Old Property| Old Default| New Property| New Default| Description
| handlers
| java.util.logging.ConsoleHandler
| handlers
| fish.payara.jul.handler.SimpleLogHandler,
fish.payara.jul.handler.PayaraLogHandler
| List of root handlers. Handler handles LogRecord instances and distributes them to some output (file, stream, mail, memory, jms, …)

| handlerServices
| com.sun.enterprise.server.logging.GFFileHandler,
com.sun.enterprise.server.logging.SyslogHandler
| --
| --
| List of root handlers configured programatically. Now logging does not depend on HK2 services, but LogManagerService
depends on logging and reconfigures it.
|===

=== PayaraLogHandler

Replacement for GFFileHandler, so properties are basically the same.

|===
| Old Property| Old Default| New Property| new Default| Description

| logtoFile
| true
| enabled
| true
| If false, it remains in the JUL system, but ignores all incoming log records.

| level
| ALL
| level
| ALL
| threshold for incoming LogRecords

| encoding
| UTF-8
| encoding
| UTF-8
| Output file charset

| file
| ${com.sun.aas.instanceRoot}/logs/server.log
| file
| ${com.sun.aas.instanceRoot}/logs/server.log
| Writable output file

| --
| --
| buffer.capacity
| 10 000
| LogRecord buffer size. If the buffer is full and it is not possible to add new record for buffer.timeout seconds,
buffer will reset and replace all records with just one severe message explaining what happened. Error is also reported to STDERR.

| --
| --
| buffer.timeoutInSeconds
| 0
| 0 means wait forever. May cause deadlock, on the other hand, it will not lose any data, just decrease the app performance.

| flushFrequency
| 1
| flushFrequency
| 1
| Count of records, after which handler calls flush on the output stream

| logStandardStreams
redirectStandardStreams
| true
| redirectStandardStreams
| true
| If true, redirects STDOUT and STDERR to this handler. Obviously, you can do that just with one handler.

| compressOnRotation
| false
| rotation.compress
| false
| Compress rolled file as zip

| rotationOnDateChange
| false
| rotation.rollOnDateChange
| false
| Roll at midnight

| rotationLimitInBytes
| 2 000 000
| rotation.limit.megabytes
| 2
| When the record is written and the file crossed the limit, the file is renamed and logging continues with the new one.

| rotationTimelimitInMinutes
| 0
| rotation.limit.minutes
| 0
| The file is renamed after given number of minutes and logging starts with the new one.

| maxHistoryFiles
| 0
| rotation.maxArchiveFiles
| 0
| The maximal count of rolled files. The oldest one is deleted then.

| logtoConsole
| false
| --
| --
| This property wasn't used.

| retainErrorsStasticsForHours
| 0
| --
| --
| This property wasn't used since Sun's application servers.

| formatter
| com.sun.enterprise.server.logging.ODLLogFormatter
| formatter
| fish.payara.jul.formatter.ODLLogFormatter
| Defines format of the textual output

| --
| --
| formatter.*
| --
| This is the most important change in properties.
Now all properties used by handler's formatter can be set by adding the property name behind the formmatter.
However, this is suppoprted just by Payara's formatters and handlers.

|====

=== SimpleLogHandler

Replacement for ConsoleHandler.

|===
| Old Property| Old Default| New Property| new Default| Description

| --
| --
| useErrorStream
| false
| While ConsoleHandler always uses STDERR, SLH uses STDOUT by default, can switch to STDERR

| formatter
| com.sun.enterprise.server.logging.ODLLogFormatter
| formatter
| fish.payara.jul.formatter.ODLLogFormatter
| Defines format of the textual output

| --
| --
| formatter.*
| --
| This is the most important change in properties.
Now all properties used by handler's formatter can be set by adding the property name behind the formmatter.
However, this is suppoprted just by Payara's formatters and handlers.

|===


== Formatters

=== OneLineFormatter

This is a simple formatter most useful for tests, where you do care about the timestamp, level, thread name, message
and source class and method, but you don't want to read long list of a unimportant informations.

|===
| Old Property| Old Default| New Property| new Default| Description

| --
| --
| timestampFormat
| HH:mm:ss.SSS
| Other formatters print date by default, but this one is used usually just in tests, so it would produce just more noise.

| --
| --
| printSource
| true
| Class and method, which created the LogRecord. Can be null, same as with SimpleFormatter, some packages are ignored.
Then it uses logger name. If false, it just uses logger name instead.

| --
| --
| size.level
| 7
| Count of characters for the level

| --
| --
| size.thread
| 20
| Count of characters for the  thread name

| --
| --
| size.class
| 60
| Count of characters for the source class
|===

=== JSONLogFormatter

|===
| Old Property| Old Default| New Property| new Default| Description

| com.sun.enterprise.server.logging.GFFileHandler.excludeFields
| ""
| excludedFields
| ""
| Fields which should not be printed to the output. ecid and userId were never set, in history they could be set as JVM options
|===

=== ODLLogFormatter

|===
| Old Property| Old Default| New Property| new Default| Description

| --
| Example:
2011-12-03T15:35:40.123+0100
| timestampFormat
| Example:
2011-12-03T15:35:40.123+01:00
| Changed from old RFC_3339 to ISO-8601 timestamp, the old version did not use : in timezone offset

| (Never used JVM option)
| false
| printSource
| false
| If true, prints source class and method

| ansiColor
| false
| ansiColor.enabled
| false
| Enables ANSI colors for logger name and level

| loggerColor
| BOLD_INTENSE_BLUE
| ansiColor.logger
| BOLD_INTENSE_BLUE
|

| infoColor
| BOLD_INTENSE_GREEN
| ansiColor.info
| BOLD_INTENSE_GREEN
|

| warnColor
| BOLD_INTENSE_YELLOW
| ansiColor.warn
| BOLD_INTENSE_YELLOW
|

| severeColor
| BOLD_INTENSE_RED
| ansiColor.severe
| BOLD_INTENSE_RED
|

| com.sun.enterprise.server.logging.GFFileHandler.excludeFields
| ""
| excludedFields
| ""
| Fields which should not be printed to the output. ecid and userId were never set, in history they could be set as JVM options

| com.sun.enterprise.server.logging.GFFileHandler.multiLineMode
| true
| multiline
| true
| If false, the formatter will not add a new line before the message.

| --
| “ “
| fieldSeparator
| “ “
| Custom separator which can be used to separate log record fields.

|===

=== UniformLogFormatter

|===
| Old Property| Old Default| New Property| new Default| Description

| --
| 2011-12-03T15:35:40.123+0100
| timestampFormat
| 2011-12-03T15:35:40.123+01:00
| RFC_3339 → ISO-8601 timestamp, the old version did not use : in timezone offset

| (Never used JVM option)
| false
| printSequenceNumber
| false
| Not used in any other formatter, but always available - set by JUL LogRecord

| (Never used JVM option)
| false
| printSource
| false
|

| ansiColor
| false
| ansiColor.enabled
| false
|

| loggerColor
| BOLD_INTENSE_BLUE
| ansiColor.logger
| BOLD_INTENSE_BLUE
|

| infoColor
| BOLD_INTENSE_GREEN
| ansiColor.info
| BOLD_INTENSE_GREEN
|

| warnColor
| BOLD_INTENSE_YELLOW
| ansiColor.warn
| BOLD_INTENSE_YELLOW
|

| severeColor
| BOLD_INTENSE_RED
| ansiColor.severe
| BOLD_INTENSE_RED
|

| com.sun.enterprise.server.logging.GFFileHandler.excludeFields
| ““
| excludedFields
| ““
|

| com.sun.enterprise.server.logging.GFFileHandler.multiLineMode
| true
| multiline
| true
|

| com.sun.enterprise.server.logging.GFFileHandler.logFormatFieldSeparator
| \|
| fieldSeparator
| \|
|

| com.sun.enterprise.server.logging.GFFileHandler.logFormatBeginMarker
| [#
| recordMarker.begin
| [#
|

| com.sun.enterprise.server.logging.GFFileHandler.logFormatEndMarker
| \|#]
| recordMarker.end
| \|#]
|

|===


